@using KurbSide.Controllers
@using KurbSide.Utilities
@model IEnumerable<KurbSide.Models.Item>

@{
    ViewData["Title"] = "AddItemsToSale";

    var discountPercentage = ViewData["salePercentage"];
    var saleId = (Guid)ViewData["saleId"];
}
<script src="~/js/Business/Sales/AddItemToSale.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">

<h1>AddItemsToSale</h1>

<table class="table">
    <thead>
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.ItemName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Details)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Price)
        </th>
        <th>
            Price With Discount
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Category)
        </th>
        <th>
            &nbsp;
        </th>
        <th>
            &nbsp;
        </th>
    </tr>
    </thead>
    <tbody>
    @foreach (var item in Model)
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.ItemName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Details)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Price)
            </td>
            <td>
                @(((decimal) item.Price - ((decimal) item.Price * (decimal) discountPercentage / 100)).ToString("$#0.00"))
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Category)
            </td>
            <td>
                <input type="radio" class="btn-check" name="saleItem-@item.ItemId" id="addToSale-@item.ItemId" @if(KSOrderUtilities.KSCheckIfItemInSale(item, saleId)){<text>checked</text>}>
                <label class="btn btn-outline-success" for="addToSale-@item.ItemId">Add</label>
            </td>
            <td>
                <input type="radio" class="btn-check" name="saleItem-@item.ItemId" id="removeFromSale-@item.ItemId" @if(!KSOrderUtilities.KSCheckIfItemInSale(item, saleId)){<text>checked</text>}>
                <label class="btn btn-outline-danger" for="removeFromSale-@item.ItemId">Remove</label>
            </td>
        </tr>

        <script type="text/javascript">
                        document.getElementById('addToSale-@item.ItemId').addEventListener("click", function (){ addToSale('@saleId', '@item.ItemId', '@BusinessController.AddOrRemove.ADD')})
                        document.getElementById('removeFromSale-@item.ItemId').addEventListener("click", function(){ addToSale('@saleId', '@item.ItemId', '@BusinessController.AddOrRemove.REMOVE')})
            </script>
    }
    </tbody>
</table>